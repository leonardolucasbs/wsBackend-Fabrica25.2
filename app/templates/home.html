<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Biblioteca Online</title>
  <style>
    :root{
      --bg:#0b0c10; --muted:#9aa3af; --card:#111318; --card-2:#151821;
      --text:#e5e7eb; --primary:#7c5cff; --primary-2:#6a4af7;
      --ring:rgba(124,92,255,.35); --border:#202431; --accent:#1b2030;
      --shadow:0 10px 30px rgba(0,0,0,.25); --radius:16px;
    }
    @media (prefers-color-scheme: light){
      :root{ --bg:#f8fafc; --card:#ffffff; --card-2:#f9fafb; --text:#0f172a;
        --muted:#64748b; --border:#e5e7eb; --accent:#eef2ff;
        --shadow:0 10px 30px rgba(2,6,23,.08); --ring:rgba(124,92,255,.2); }
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0;
      background:radial-gradient(1000px 500px at 120% -10%, var(--accent), transparent 60%), var(--bg);
      color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif;
    }
    .container{max-width:1200px; margin:0 auto; padding:24px}

    header{display:grid; grid-template-columns:1fr auto; gap:16px; margin-bottom:24px; align-items:center}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:40px; height:40px; border-radius:10px; background:linear-gradient(135deg,var(--primary),var(--primary-2)); box-shadow:0 8px 24px var(--ring)}
    h1{font-size:clamp(1.25rem,2vw,1.75rem); margin:0}
    .muted{color:var(--muted); font-size:.95rem}

    /* barra de busca + botão no topo */
    .header-actions{display:flex; gap:10px; align-items:center}
    .search{
      display:flex; gap:10px; align-items:center; width:100%;
      background:linear-gradient(180deg,var(--card),var(--card-2));
      border:1px solid var(--border); border-radius:14px; padding:8px; box-shadow:var(--shadow);
    }
    .search input{
      flex:1; background:transparent; border:none; color:var(--text);
      padding:10px 12px; outline:none; font-size:1rem;
    }
    .btn{
      appearance:none; border:none; cursor:pointer; text-decoration:none;
      padding:10px 14px; border-radius:12px; font-weight:600; font-size:.95rem; line-height:1;
      display:inline-flex; align-items:center; justify-content:center;
      transition:transform .12s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
    }
    .btn:active{transform:translateY(1px)}
    .btn-primary{color:#fff; background:linear-gradient(135deg,var(--primary),var(--primary-2)); box-shadow:0 8px 24px var(--ring)}
    .btn-ghost{color:var(--text); background:transparent; border:1px solid var(--border)}
    .btn-ghost:hover{border-color:var(--ring); background:rgba(124,92,255,.08)}

    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:18px}
    .card{
      background:linear-gradient(180deg,var(--card),var(--card-2));
      border:1px solid var(--border); border-radius:var(--radius);
      overflow:hidden; box-shadow:var(--shadow); display:flex; flex-direction:column;
      transition:transform .25s ease, box-shadow .25s ease, border-color .25s ease
    }
    .card:hover{transform:translateY(-4px); box-shadow:0 16px 40px rgba(0,0,0,.35); border-color:var(--ring)}
    .thumb{position:relative; aspect-ratio:3/4; background:#0f1220; display:flex; align-items:center; justify-content:center; border-bottom:1px solid var(--border); overflow:hidden}
    .thumb img{width:100%; height:100%; object-fit:cover; display:block; transform:scale(1.01)}
    .thumb .placeholder{width:48px; height:64px; border:2px dashed #334155; border-radius:10px; opacity:.6}
    .content{padding:14px 14px 12px}
    .title{margin:0 0 6px; font-weight:700; line-height:1.25; font-size:1.05rem}
    .meta{display:flex; flex-wrap:wrap; gap:10px 16px; margin-bottom:12px}
    .chip{font-size:.82rem; color:var(--muted); padding:6px 10px; border:1px solid var(--border); background:rgba(255,255,255,.02); border-radius:999px}
    .actions{margin-top:auto; padding:0 14px 14px; display:flex; gap:10px; flex-wrap:wrap}
    @media (max-width:640px){ header{grid-template-columns:1fr; gap:10px} .header-actions{flex-direction:column; align-items:stretch} }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Biblioteca Online</h1>
          <div class="muted">
            {% if q %}Resultados para “{{ q }}”{% else %}Explore e alugue seus livros favoritos{% endif %}
          </div>
        </div>
      </div>

    
      <div class="header-actions">
        <form class="search" method="get" action="">
          <input
            type="text"
            name="q"
            value="{{ q|default_if_none:'' }}"
            placeholder="Pesquisar livros (ex.: Python, Romance, IA)..."
            aria-label="Pesquisar livros"
            required
          />
          <button class="btn btn-primary" type="submit">Pesquisar</button>
        </form>
        <a class="btn btn-primary" href="{% url 'logout' %}">Sair</a>
        <a class="btn btn-primary" href="{% url 'locacoes' %}">Meus aluguéis</a>
      </div>
    </header>

    <main class="grid">
      {% for livro in livros %}
        <article class="card">
          <div class="thumb">
            {% if livro.capa_id %}
              <img src="https://covers.openlibrary.org/b/id/{{ livro.capa_id }}-L.jpg" alt="Capa de {{ livro.titulo }}">
            {% else %}
              <div class="placeholder" aria-hidden="true"></div>
            {% endif %}
          </div>

          <div class="content">
            <h2 class="title">{{ livro.titulo }}</h2>
            <div class="meta">
              <span class="chip">Autor: {{ livro.autor }}</span>
              <span class="chip">Ano: {{ livro.ano }}</span>
            </div>
          </div>

          <div class="actions">

            <a class="btn btn-ghost"
               href="{% url 'alugarLivro' %}?titulo={{ livro.titulo|urlencode }}&autor={{ livro.autor|urlencode }}
               {% if livro.capa_id %}&capa_id={{ livro.capa_id }}{% endif %}
               {% if livro.ano %}&ano={{ livro.ano|urlencode }}{% endif %}
               {% if livro.key %}&key={{ livro.key|urlencode }}{% endif %}">
              Alugar
            </a>

            <!-- Ver mais: link externo da OpenLibrary -->
            <a class="btn btn-primary"
               href="https://openlibrary.org{{ livro.key }}"
               target="_blank" rel="noopener noreferrer" title="Ver mais">
              Ver mais
            </a>
          </div>
        </article>
      {% endfor %}
    </main>
  </div>
</body>
</html>
